{% extends "Layout.html" %}
{% block title %}Result{% endblock %}
{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="{{ url_for('static', filename='CSS/table.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='CSS/form.css') }}">
{% endblock %}
{% block navbar %}
<!-- Navbar -->
<div class="w3-top">
  <div class="w3-bar siemens-blue w3-card w3-left-align w3-large">
    <a class="w3-bar-item w3-button w3-hide-medium w3-hide-large w3-right w3-padding-large w3-hover-white w3-large siemens-blue" href="javascript:void(0);" onclick="myFunction()" title="Toggle Navigation Menu"><i class="fa fa-bars"></i></a>
    <a href="{{ url_for('get_main_page') }}" class="w3-bar-item w3-button w3-padding-large w3-hover-white">Home</a>
    <a href="{{ url_for('upload_file_page') }}" class="w3-bar-item w3-button w3-padding-large w3-hover-white">Start</a>
    <a href="#" class="w3-bar-item w3-button w3-hide-small w3-padding-large  w3-white">Result</a>
    {% if user %}
    <div class="w3-bar-item w3-button w3-hide-small w3-padding-large  w3-white bar-right">{{user}}</div>
    <a href="{{ url_for('logout') }}" class="w3-bar-item w3-button w3-padding-large w3-hover-white bar-right">Logout</a>
    <a href="{{ url_for('get_projects_result_list') }}" class="w3-bar-item w3-button w3-padding-large w3-hover-white bar-right">Results</a>
    <a href="{{ url_for('get_projects_solver') }}" class="w3-bar-item w3-button w3-padding-large w3-hover-white bar-right">Solver Settings</a>
    {% endif %}
  </div>
</div>
{% endblock %}
{% block body %}

<div class="w3-row-padding w3-padding-64 w3-container">
  <div class="w3-content">
     <h1>Results{% if name %} of {{name}}{% endif %}</h1>
    <div id="resultDiv">
    {% if result != "-" %}
      <p id="finalPorosity">Final porosity: <div class="boldText">{{result["porosity"]}}</div></p>
      <p id="finalLossFuncVal">Final loss function value: <div class="boldText">{{result["lv1lossfunctionval"]}}</div></p><br>
        <table>
          <thead>
            <tr>
              <th>Component</th>
              <th>K</th>
              <th>D</th>
              {% if result["solver"] == "Nonlin" %}
              <th>Q</th>
              {% endif %}
              <th>Loss Function Value</th>
            </tr>
          </thead>
          <tbody>
            {% for comp in compList %}
            <tr>
              <td>{{comp}}</td>
              <td>{{result["compparams"][comp][0]|round(2)}}</td>
              <td>{{result["compparams"][comp][1]|round(2)}}</td>
              {% if result["solver"] == "Nonlin" %}
              <td>{{result["compparams"][comp][2]|round(2)}}</td>
              {% endif %}
              <td>{{result["lv2lossfunctionvals"][comp]|round(2)}}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
    {% else %}
    Working<div id="dotsDiv" class="inline">...</div>
    {% endif %}
      <br><br>

      <div id="additionalInfoDiv" {% if result == '-' %}style="display: none;"{% endif %}>
        <h2>Show loss function value progress</h2>
        <form method=post enctype=multipart/form-data id="mainform" class="form-style-1">
          <label for="componentTest">Choose a Component</label>
          <select name="componentTest" id="componentTest" onchange="formCompChangeForTest2()">
            {% for comp in compList %}
            <option value="{{comp}}">{{comp}}</option>
            {% endfor %}
            <option value="all">All</option>
          </select><br>
          {% for comp in compList %}
          <div id="expListDiv{{comp}}" {% if comp != 'Sac' %}style="display:none;"{% endif %} class="expListDiv">
            <label for="expList{{comp}}">Select Experiment for {{comp}} <div class="required">*</div></label>
            <select name="expList{{comp}}" id="expList{{comp}}">
              {% for exp in compExpDict[comp] %}
              <option value="{{exp}}">{{exp}}</option>
              {% endfor %}
            <option value="all">All</option>
            </select>
          </div>
          {% endfor %}
          <a type="button" onclick="showGraph3()" class="w3-button siemens-blue w3-padding-large w3-large w3-margin-top w3-round">Graph</a>
        </form>
      <div id="imgdiv">
      </div>
      </div>

      <div id="additionalInfoDiv2" {% if result == '-' %}style="display: none;"{% endif %}>
        <h2>Compare experimental data with result</h2>
        <form method=post enctype=multipart/form-data id="mainform2" class="form-style-1">
          <label for="expList2">Select Experiment <div class="required">*</div></label>
          <select name="expList2" id="expList2" onchange="formExpChangeForResult('expList2', 'compListDiv2')">
            {% for exp, val in expDict.items() %}
            <option value="{{loop.index0}}">{{exp}}</option>
            {% endfor %}
          </select>
          {% for exp, val in expDict.items() %}
            <div id="compListDiv2{{loop.index0}}" {% if loop.index0 != 0 %}style="display:none;"{% endif %} class="compListDiv2">
              <label for="componentTest2{{loop.index0}}">Choose a Component for {{exp}}</label>
              <select name="componentTest2{{loop.index0}}" id="componentTest2{{loop.index0}}">
                {% for comp in val %}
                <option value="{{loop.index0}}">{{comp}}</option>
                {% endfor %}
                <option value="all">All</option>
              </select><br>
            </div>
          {% endfor %}
          <a type="button" onclick="showGraph2('mainform2', '/rescomp', 'imgdiv2', 'downloadMatrixButton')" class="w3-button siemens-blue w3-padding-large w3-large w3-margin-top w3-round">Graph</a>
          <a type="button" id="downloadMatrixButton" onclick="downloadMatrix('graphImg2')" class="w3-button siemens-blue w3-padding-large w3-large w3-margin-top w3-round" style="display: none;">Download Result</a>
          <iframe id="invis_iframe" style="display:none;"></iframe>
        </form>
      <div id="imgdiv2">
      </div>
      </div>

    </div>
  </div>
</div>
<script type="text/javascript">
    {% if result == "-" %}
      getResult()
    {% endif %}
</script>
{% endblock %}